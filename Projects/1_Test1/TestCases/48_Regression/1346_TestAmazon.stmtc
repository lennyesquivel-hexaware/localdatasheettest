[
  {
    "TempId": 1346,
    "AUT": "",
    "Description": "",
    "StatusKey": "NEW",
    "isMobile": false,
    "TestCaseType": 1,
    "IsExecutable": true,
    "uri": "",
    "DataSheet": {
      "TestCase": null,
      "Parameters": [
        {
          "TempId": 858,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "1",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "2",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "3",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "4",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "5",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "6",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "7",
              "ParameterId": 858,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "Iteration",
          "Created": null,
          "Modified": null
        },
        {
          "TempId": 859,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "0",
              "ParameterId": 859,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "Skip",
          "Created": null,
          "Modified": null
        },
        {
          "TempId": 860,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "omnihil (8ft) Cable de alimentación de CA para Asus g11df-dbr5-gtx1060 PC de sobremesa procesador AMD ryzen 5 procesador GTX 1060 – color blanco",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "MSI ProSeries AMD A320 1ª 2ª 3ª generación compatible con Ryzen AM4 DDR4 HDMI DVI M.2 USB 3 Micro-ATX placa base (A320M-A PRO MAX)",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "Dolgix- 8GB DDR4 PC4-17000 2133MHz for Desktop PC4-2133 Memory Non ECC Low Density RAM",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "Lenink CR2 Battery Eliminator Power Supply Adapter",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "Montech Flyer- Black/Micro ATX Mini-ITX/Pre-Installed 2 Fans/High-Airflow/Computer Gaming Case/Hairline Surface Front Panel/RGB LED Shinning Strip/Three Versions Lighting Effects",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "ASUS AMD Radeon RX 5500XT Overclocked O8G GDDR6 Dual Fan EVO Edition HDMI DisplayPort Gaming Graphics Card (DUAL-RX5500XT-O8G-EVO) Tarjeta gráfica",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "Sceptre 24\" Curvo 75Hz Gaming LED Monitor Full HD 1080P HDMI VGA Altavoces VESA Montaje en Pared Ready Metal Negro 2019 (C248W-1920RN) Negro Metálico",
              "ParameterId": 860,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "DT_Product",
          "Created": null,
          "Modified": null
        },
        {
          "TempId": 861,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "14.96",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "54.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "24.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "11.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "48.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "209.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "109.99",
              "ParameterId": 861,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "DT_Price",
          "Created": null,
          "Modified": null
        },
        {
          "TempId": 862,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "ryzen 5 procesador",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "placa base am4",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "ram ddr4 8gb",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "power supply",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "micro atx case",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "graphics card",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "1080p 24\" monitor",
              "ParameterId": 862,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "DT_Item",
          "Created": null,
          "Modified": null
        },
        {
          "TempId": 863,
          "Iterations": [
            {
              "Iteration": 1,
              "Value": "https://www.amazon.com/-/es/gp/slredirect/picassoRedirect.html/ref=pa_sp_mtf_aps_sr_pg2_1?ie=UTF8&adId=A07366058LNW26BUUYZU&url=%2Falimentaci%25C3%25B3n-g11df-dbr5-gtx1060-PC-sobremesa-procesador-procesador%2Fdp%2FB07B1FGX82%2Fref%3Dsr_1_27_sspa%3F__mk_es_US%3D%25C3%2585M%25C3%2585%25C5%25BD%25C3%2595%25C3%2591%26keywords%3Dryzen%2B5%2Bprocessor%26qid%3D1580233466%26sr%3D8-27-spons%26psc%3D1&qualifier=1580233466&id=4365814551865752&widgetName=sp_mtf",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 2,
              "Value": "https://www.amazon.com/-/es/ProSeries-generaci%C3%B3n-compatible-PRO-MAX/dp/B0822M7BS5/ref=sr_1_12?__mk_es_US=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=am4+motherboard&qid=1580233485&sr=8-12",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 3,
              "Value": "https://www.amazon.com/-/es/dp/B083B63KRV/ref=sr_1_68?__mk_es_US=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=ram+HDR4+8gb&qid=1580233537&sr=8-68",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 4,
              "Value": "https://www.amazon.com/-/es/gp/slredirect/picassoRedirect.html/ref=pa_sp_mtf_aps_sr_pg2_2?ie=UTF8&adId=A0706311385961FEF8AFN&url=%2Fdp%2FB082M5TKCF%2Fref%3Dsr_1_28_sspa%3F__mk_es_US%3D%25C3%2585M%25C3%2585%25C5%25BD%25C3%2595%25C3%2591%26keywords%3Dpower%2Bsupply%26qid%3D1580233556%26sr%3D8-28-spons%26psc%3D1&qualifier=1580233556&id=2291901110544165&widgetName=sp_mtf",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 5,
              "Value": "https://www.amazon.com/-/es/dp/B081Q7SD7L/ref=sr_1_18?__mk_es_US=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=micro+atx+case&qid=1580233577&sr=8-18",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 6,
              "Value": "https://www.amazon.com/-/es/Overclocked-DisplayPort-Graphics-DUAL-RX5500XT-O8G-EVO-Tarjeta/dp/B082G4J2WG/ref=sr_1_83?__mk_es_US=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=graphics+card&qid=1580233623&sr=8-83",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            },
            {
              "Iteration": 7,
              "Value": "https://www.amazon.com/-/es/Sceptre-Monitor-Altavoces-C248W-1920RN-Met%C3%A1lico/dp/B07KXSR99Y/ref=sr_1_35?__mk_es_US=%C3%85M%C3%85%C5%BD%C3%95%C3%91&keywords=24%22+monitor+1080p&qid=1580233640&sr=8-35",
              "ParameterId": 863,
              "Skip": 0,
              "Name": null,
              "Created": null,
              "Modified": null
            }
          ],
          "DataSheetId": 1346,
          "Name": "DT_Link",
          "Created": null,
          "Modified": null
        }
      ],
      "Name": "TestAmazon",
      "Created": null,
      "Modified": null
    },
    "Scenario": null,
    "Authentication": null,
    "TestSteps": [
      {
        "TempId": 5610,
        "StepNumber": 1,
        "ActionId": 55,
        "ComponentId": 1121,
        "CustomActionId": null,
        "StepSectionId": 2,
        "ObjectDictionaryId": null,
        "ImageRepositoryId": null,
        "LocatorTypeId": null,
        "Screenshot": false,
        "SkipStep": false,
        "Description": "AmazonSearch",
        "Locator": null,
        "Value": null,
        "Status": "Pending",
        "UserSays": null,
        "BotSays": null,
        "Parameters": [
          {
            "TestCaseId": 1346,
            "TestCaseStepId": 5610,
            "ComponentId": 1121,
            "ComponentStepId": 1581,
            "TestCase": null,
            "Value": "https://www.amazon.com/",
            "TempId": 0,
            "qTestStepKey": null,
            "Name": null,
            "Created": null,
            "Modified": null
          },
          {
            "TestCaseId": 1346,
            "TestCaseStepId": 5610,
            "ComponentId": 1121,
            "ComponentStepId": 1582,
            "TestCase": null,
            "Value": "DT_Item",
            "TempId": 0,
            "qTestStepKey": null,
            "Name": null,
            "Created": null,
            "Modified": null
          },
          {
            "TestCaseId": 1346,
            "TestCaseStepId": 5610,
            "ComponentId": 1121,
            "ComponentStepId": 1583,
            "TestCase": null,
            "Value": null,
            "TempId": 0,
            "qTestStepKey": null,
            "Name": null,
            "Created": null,
            "Modified": null
          }
        ],
        "Assertions": [],
        "qTestStepId": null,
        "Name": null,
        "Created": null,
        "Modified": null
      },
      {
        "TempId": 5609,
        "StepNumber": 2,
        "ActionId": 1,
        "ComponentId": null,
        "CustomActionId": 122,
        "StepSectionId": 2,
        "ObjectDictionaryId": null,
        "ImageRepositoryId": null,
        "LocatorTypeId": null,
        "Screenshot": false,
        "SkipStep": false,
        "Description": "FindLowestPrice",
        "Locator": null,
        "Value": "DT_Item",
        "Status": "Pending",
        "UserSays": null,
        "BotSays": null,
        "Parameters": [],
        "Assertions": [],
        "qTestStepId": null,
        "Name": null,
        "Created": null,
        "Modified": null
      }
    ],
    "GRDomainNameandId": null,
    "qTestTestCaseId": null,
    "Name": "TestAmazon",
    "Created": null,
    "Modified": null
  },
  {
    "TempId": 1121,
    "Description": "",
    "isMobile": false,
    "TestCaseType": 1,
    "Steps": [
      {
        "TempId": 1581,
        "StepNumber": 1,
        "Description": null,
        "LocatorTypeId": null,
        "Locator": null,
        "ActionId": 27,
        "ParameterName": null,
        "ParameterValue": "https://www.amazon.com/",
        "CustomActionId": null,
        "ObjectDictionaryId": null,
        "ImageRepositoryId": null,
        "SkipStep": false,
        "Screenshot": false,
        "UserSays": null,
        "BotSays": null,
        "Parameters": [],
        "qTestStepIdForComp": null,
        "Name": null,
        "Created": null,
        "Modified": null
      },
      {
        "TempId": 1582,
        "StepNumber": 2,
        "Description": null,
        "LocatorTypeId": 3,
        "Locator": "twotabsearchtextbox",
        "ActionId": 43,
        "ParameterName": null,
        "ParameterValue": "DT_Item",
        "CustomActionId": null,
        "ObjectDictionaryId": null,
        "ImageRepositoryId": null,
        "SkipStep": false,
        "Screenshot": false,
        "UserSays": null,
        "BotSays": null,
        "Parameters": [],
        "qTestStepIdForComp": null,
        "Name": null,
        "Created": null,
        "Modified": null
      },
      {
        "TempId": 1583,
        "StepNumber": 3,
        "Description": null,
        "LocatorTypeId": 7,
        "Locator": "//input[@value='Ir']",
        "ActionId": 9,
        "ParameterName": null,
        "ParameterValue": null,
        "CustomActionId": null,
        "ObjectDictionaryId": null,
        "ImageRepositoryId": null,
        "SkipStep": false,
        "Screenshot": false,
        "UserSays": null,
        "BotSays": null,
        "Parameters": [],
        "qTestStepIdForComp": null,
        "Name": null,
        "Created": null,
        "Modified": null
      }
    ],
    "isPOM": true,
    "TestSteps": [],
    "Name": "AmazonSearch",
    "Created": null,
    "Modified": null
  },
  {
    "TempId": 122,
    "Description": "",
    "Code": "////<Mandatory_libraries>\nimport org.openqa.selenium.By;\nimport org.openqa.selenium.InvalidElementStateException;\nimport org.openqa.selenium.JavascriptExecutor;\nimport org.openqa.selenium.Keys;\nimport org.openqa.selenium.NoSuchElementException;\nimport org.openqa.selenium.WebDriver;\nimport org.openqa.selenium.WebElement;\nimport org.openqa.selenium.interactions.Action;\nimport org.openqa.selenium.interactions.Actions;\nimport org.openqa.selenium.remote.CapabilityType;\nimport org.openqa.selenium.remote.DesiredCapabilities;\nimport org.openqa.selenium.remote.RemoteWebDriver;\nimport org.openqa.selenium.support.ui.ExpectedConditions;\nimport org.openqa.selenium.support.ui.Select;\nimport org.openqa.selenium.support.ui.WebDriverWait;\nimport stmJava.ActionResult;\nimport stmJava.CustomStep;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.concurrent.atomic.AtomicReference;\n\n//</Mandatory_libraries>\n// Additional libraries might be declared here\n\n\n//<This_lines_must_not_be_modified>\n   public class FindLowestPrice extends ActionResult\n   {\n       /// <summary>\n       /// A method to perform a custom test step\n       /// </summary>\n       /// <param>\n       /// The method receive parameters:\n       /// \t* driver which is an instance of WebDriver or a mobile driver such as AndroidDriver\n       /// \n       /// \t* and a second optional parameter which can be a String or a String[] array.\n       /// \t  One Parameter : public ActionResult Execute(WebDriver driver)\n       /// \t  Two Parameters: public ActionResult Execute(WebDriver driver, String inputValue)\n       ///              or: public ActionResult Execute(WebDriver driver, String[] inputValue)\n       /// </param>\n       /// <returns>\n       ///  The method returns an ActionResult object which is expected to contain the step\n       ///  execution information, such as the status (true or false equivalent to pass or fail), details \n       ///  that may explain the fail cause or some extra information and  the path to find the file resulting \n       ///  of a screenshot.\n       /// </returns>\n       ///  Also it is possible to save a String value to Datasheet.\n       ///  e.g. 1:\n       ///   actionResult.SaveParameterValue(\"DT_ParamName\", paramValue);\n       ///   actionResult.SaveParameterValue(\"GDT_ParamName\", paramValueGlobal);\n       ///  e.g. 2:\n       ///   actionResult.columnName = \"DatasheetColumnName\";\n       ///   actionResult.propertyValue = \"Value to be saved\";\n       ///  Or save several values to Datasheet.\n       ///   actionResult.ColumnNames.add('DatasheetColumnName1');\n       ///   actionResult.PropertyValues.add(Value to be saved1);\n       ///   actionResult.ColumnNames.add('DatasheetColumnNameN');\n       ///   actionResult.PropertyValues.add(Value to be savedN);\n       //</This_lines_must_not_be_modified>\n       //<Mandatory_lines>\n\n\tpublic static Map<String, String> linkMap;\n\n       public ActionResult Execute(WebDriver driver, String inputValue) //replace WebDriver by AndroidDriver for mobile actions\n       {\n           ActionResult actionResult = new ActionResult();\n           actionResult.status = false;\n           actionResult.comments =  \"\";\n       //</Mandatory_lines>\n       ///////////////WORKSPACE START////////////////////////////////////////////////////////////////////////////////////////\n       \n\ttry{\n\t\tlinkMap = new HashMap<String, String>();\n\t\tMap<String, String> productsMap = getProducts(driver, inputValue);\n\t\tfor (int i = 0; i < 5; i++){\n\t\t\tdriver.findElement(By.xpath(\"//*[text() = 'Siguiente']\")).click();\n\t\t\tproductsMap.putAll(getProducts(driver, inputValue));\n\t\t}\n\t\tAtomicReference<String> minValue = new AtomicReference<>();\n\t\tAtomicReference<String> minKey = new AtomicReference<>();\n\t\tString[] values = productsMap.values().toArray(new String[0]);\n\t\tString[] keys = productsMap.keySet().toArray(new String[0]);\n\t\tminValue.set(values[0].toString());\n\t\tminKey.set(keys[0].toString());\n\t\tfor (int i = 0; i < keys.length; i++) {\n\t\t\tif(Float.valueOf(values[i].toString()) < Float.valueOf(minValue.get())) {\n\t\t\t\tminValue.set(values[i].toString());\n\t\t\t\tminKey.set(keys[i].toString());\n\t\t\t}\n\t\t}\n\t\tactionResult.SaveParameterValue(\"DT_Product\", minKey.get());\n\t\tactionResult.SaveParameterValue(\"DT_Price\", minValue.get());\n\t\tactionResult.SaveParameterValue(\"DT_Link\", linkMap.get(minKey.get()));\n\t\tactionResult.status = true;\n\t\tactionResult.comments = \"Lowest Price = \" + minValue + \" for \" + minKey;\n\t}catch(Exception ex){\n\t\tactionResult.status = false;\n\t\tactionResult.comments = ex.getMessage();\n\t}\n\n        ///////////////WORKSPACE END////////////////////////////////////////////////////////////////////////////////////////\n       //</Mandatory_lines>\n       // Return results in ActionResult object\n           return actionResult;\n       }\n\n\tpublic static Map<String, String> getProducts(WebDriver drvr, String desiredProduct) {\n\t\tList<WebElement> products = drvr.findElements(By.xpath(\"//div[@data-index]\"));\n\t\tMap<String,String> productsMap = new HashMap<String, String>();\n\t\tfor(WebElement product : products){\n\t\t\ttry {\n\t\t\t\tint count = 0;\n\t\t\t\tString name = product.findElement(By.xpath(\".//a[@class='a-link-normal a-text-normal']\")).getText().replace(\",\",\"\");\n\t\t\t\tString price = product.findElement(By.xpath(\".//span[@class='a-price']\")).getText().replace(\"\\n\",\".\").replace(\"US$\",\"\").replace(\",\",\"\").trim();\n\t\t\t\tString link = product.findElement(By.xpath(\".//a[@class='a-link-normal a-text-normal']\")).getAttribute(\"href\").toString();\n\t\t\t\tif(desiredProduct.contains(\" \")){\n\t\t\t\t\tString[] productArray = desiredProduct.split(\" \");\n\t\t\t\t\tfor (String word : productArray) {\n\t\t\t\t\t\tif(name.toLowerCase().contains(word.toLowerCase()))\n\t\t\t\t\t\t\tcount ++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(name.toLowerCase().contains(desiredProduct.toLowerCase()) || (count > 2)){\n\t\t\t\t\tproductsMap.put(name, price);\n\t\t\t\t\tlinkMap.put(name, link);\n\t\t\t\t}\n\t\t\t} catch (NoSuchElementException ex) { }\n\t\t}\n\t\treturn productsMap;\n\t}\n\n   }\n //</Mandatory_lines>\n",
    "Type": 1,
    "Name": "FindLowestPrice",
    "Created": null,
    "Modified": null
  }
]